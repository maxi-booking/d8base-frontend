<ion-card *ngIf="order">
  <ion-item lines="none">
    <ion-label>
      <div>{{ order.start_datetime | date: 'mediumDate' }}</div>
      <div>{{ order.start_datetime | date: 'hh:mm' }} â€” {{ order.end_datetime | date: 'hh:mm' }}</div>
    </ion-label>
    <app-order-status [status]="order.status"></app-order-status>
  </ion-item>

  <ng-container *ngTemplateOutlet="client; context: { $implicit: order.source === 'manual' ? order : order.client }"></ng-container>
  <ng-template #client let-client>
    <ion-item lines="none">
      <ion-avatar slot="start">
        <ion-img alt="avatar" [src]="getPhoto(client?.avatar_thumbnail)"></ion-img>
      </ion-avatar>
      <ion-label>
        {{ client.first_name }}
        {{ client.last_name }}
      </ion-label>
    </ion-item>
  </ng-template>

  <app-service-title [service]="service"></app-service-title>

  <ion-item lines="none" *ngIf="!pending; else loading">
    <ion-button [routerLink]="['/my-orders', 'inbox', order.id]" color="secondary">
      {{ 'received_orders.view' | translate }}
    </ion-button>
    <ng-container *ngIf="order.status === 'not_confirmed'">
      <ion-button slot="end" color="danger" (click)="onDiscardClick()">
        {{ 'received_orders.discard' | translate }}
      </ion-button>
      <ion-button slot="end" color="success" (click)="onAcceptClick()">
        {{ 'received_orders.accept' | translate }}
      </ion-button>
    </ng-container>
    <ng-container *ngIf="order.status === 'confirmed' || order.status === 'paid'">
      <ion-button slot="end" (click)="onCompleteClick()">
        {{ 'received_orders.complete' | translate }}
      </ion-button>
    </ng-container>
  </ion-item>
  <ng-template #loading>
    <app-loading-indicator></app-loading-indicator>
  </ng-template>
</ion-card>
