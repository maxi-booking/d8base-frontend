<app-header></app-header>
<ion-content *ngIf="profile$ | async as user">
  <app-content-wrapper>
    <div class="thumbnail-container">
      <ion-thumbnail class="profile-thumbnail">
        <ion-img [src]="avatar$ | async"></ion-img>
      </ion-thumbnail>
      <app-picture-selector [formControl]="avatarSelector"></app-picture-selector>
    </div>

    <ion-item-divider color="light">
      <ion-label>
        <h1>{{'profile-form.main'|translate}}</h1>
      </ion-label>
      <ion-button slot="end" color="medium" fill="clear" routerLink="edit/">
        <ion-icon name="create-outline"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <ion-item *ngIf="user?.first_name || user?.last_name" lines="none">{{user?.first_name}} {{user?.last_name}}</ion-item>
    <ion-item lines="none">
      <ion-icon class="pr5" name="mail-outline"></ion-icon>
      <ion-label>Email</ion-label>
      {{user?.email}}
    </ion-item>
    <ion-item lines="none">
      <ion-label> {{ 'profile-form.email' | translate }} </ion-label>
      <ion-icon *ngIf="user?.is_confirmed" color="success" name="checkmark-circle-outline" slot="end"></ion-icon>
      <ion-icon *ngIf="!user?.is_confirmed" color="danger" name="close-circle-outline" slot="end"></ion-icon>
    </ion-item>

    <ion-item-divider color="light">
      <ion-label>
        <h1>{{'profile-form.contacts'|translate}}</h1>
      </ion-label>
    </ion-item-divider>
    <app-abstract-contacts *appIfSpinner="contacts$ | async as contacts" [clientContacts]="contacts" [interactable]="true">
    </app-abstract-contacts>
    <ion-item-divider color="light">
      <ion-label>
        <h1>{{'profile-form.your-address'|translate}}</h1>
      </ion-label>
    </ion-item-divider>
    <ion-item-group>
      <ion-item lines="none">
        <ion-label position="stacked"> {{'profile-form.main-address'|translate}} </ion-label>
        <ion-button slot="end" fill="clear" color="medium" routerLink="location-edit/{{(defaultLocation$ | async)?.id}}">
          <ion-icon name="create-outline"></ion-icon>
        </ion-button>
        <app-location-viewer [location]="defaultLocation$ | async"></app-location-viewer>
      </ion-item>
      <ion-item *ngFor="let location of (additionalLocationsList$|async)" lines="none">
        <ion-label position="stacked"> {{'profile-form.additional-address'|translate}} </ion-label>
        <ion-button slot="end" fill="clear" color="medium" routerLink="location-edit/{{location.id}}">
          <ion-icon name="create-outline"></ion-icon>
        </ion-button>
        <app-location-viewer [location]="location"></app-location-viewer>
      </ion-item>
    </ion-item-group>
    <app-add-button routerLink="location-add/"> {{'profile-form.add-new-address'|translate}} </app-add-button>

    <ion-item-divider color="light">
      <ion-label>
        <h1>{{'profile-form.about'|translate}}</h1>
      </ion-label>
      <ion-button slot="end" color="medium" fill="clear" routerLink="about/">
        <ion-icon name="create-outline"></ion-icon>
      </ion-button>
    </ion-item-divider>
    <ion-item lines="none">
      <ion-label>{{'profile-form.age'|translate}}</ion-label>
      {{user?.birthday || ('profile-form.not-specified'|translate)}}
    </ion-item>
    <ion-item lines="none">
      <ion-label>{{'profile-form.nationality'|translate}}</ion-label>
      {{(user.nationality | countryById$ | async)?.name || ('profile-form.not-specified'|translate)}}
    </ion-item>
    <ion-item lines="none" *ngIf="user.languages?.length">
      <ion-label>
        <h1>{{'profile-form.languages'|translate}}:</h1>
      </ion-label>
    </ion-item>
    <app-language *ngFor="let languageId of user.languages" [languageId]="languageId"></app-language>
  </app-content-wrapper>
  <app-footer></app-footer>
</ion-content>
